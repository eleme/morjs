<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-guides/advance/complex-miniprogram-integration">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">复杂小程序集成 | MorJS</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mor.eleme.io/guides/advance/complex-miniprogram-integration"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="复杂小程序集成 | MorJS"><meta data-rh="true" name="description" content="背景"><meta data-rh="true" property="og:description" content="背景"><link data-rh="true" rel="icon" href="/img/mor-icon.svg"><link data-rh="true" rel="canonical" href="https://mor.eleme.io/guides/advance/complex-miniprogram-integration"><link data-rh="true" rel="alternate" href="https://mor.eleme.io/guides/advance/complex-miniprogram-integration" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://mor.eleme.io/guides/advance/complex-miniprogram-integration" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://5QPTLJ7YVR-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="MorJS" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.80a479bf.css">
<link rel="preload" href="/assets/js/runtime~main.b55f68b3.js" as="script">
<link rel="preload" href="/assets/js/main.6ba98fb8.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_ayyi" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://img.alicdn.com/imgextra/i1/O1CN017EoZuR20PghATY7Fw_!!6000000006842-55-tps-485-350.svg" alt="MorJS" class="themedImage_hO0g themedImage--light_pJKz"><img src="https://img.alicdn.com/imgextra/i1/O1CN017EoZuR20PghATY7Fw_!!6000000006842-55-tps-485-350.svg" alt="MorJS" class="themedImage_hO0g themedImage--dark_Mi1P"></div><b class="navbar__title text--truncate">MorJS</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/guides">文档</a><a class="navbar__item navbar__link" href="/api">API</a><a class="navbar__item navbar__link" href="/web/blog">博客</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">关于</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/guides/faq">常见问题</a></li><li><a class="dropdown__link" href="/about/community-guide">社区指南</a></li><li><a href="https://github.com/eleme/morjs/blob/master/CODE_OF_CONDUCT.md" target="_blank" rel="noopener noreferrer" class="dropdown__link">行为规范</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/guides/">1.0.0</a><a href="https://github.com/eleme/morjs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_EvzU colorModeToggle_MfKL"><button class="clean-btn toggleButton__q6L toggleButtonDisabled_RXQV" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_AZhL"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_dbIA"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_KJTu"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_W79l docsWrapper_xZ5w"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_l8LT" type="button"></button><div class="docPage_MEFR"><aside class="theme-doc-sidebar-container docSidebarContainer_MxEj"><div class="sidebarViewport_tEPJ"><div class="sidebar_qwcO"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_RujJ"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/guides/">指南</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/guides/">介绍</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/">MorJS 介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/introduction/how-mor-works">MorJS 如何工作?</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/guides/introduction/getting-started">教程</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/introduction/getting-started">快速上手</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/guides/introduction/how-to-develop-todo-list_wechat">开发一个 To-Do List</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/migrate-from-original-miniprogram-to-mor">原生小程序接入</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" tabindex="0" href="/guides/basic/directory-structure">基础用法</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/basic/directory-structure">目录结构</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/basic/config">配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/basic/runtime">运行时</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/basic/plugin">插件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/basic/mock">Mock</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/basic/env-variables">环境变量</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/basic/cli">命令行</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/faq">FAQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/guides/conditional-compile/code-level">进阶用法</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/guides/conditional-compile/code-level">条件编译</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/guides/advance/complex-miniprogram-integration">复杂小程序集成</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/advance/unity-of-forms">小程序形态一体化</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/guides/compatibilities/alipay-to-wechat">多端兼容性</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/web/basic/quickstart">Web 开发</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/guides/contributing">社区</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_MR7f"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_N74_"><div class="docItemContainer_Op65"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_wC4B" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_qPOb"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">指南</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">进阶用法</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">复杂小程序集成</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：1.0.0</span><div class="tocCollapsible_pCA_ theme-doc-toc-mobile tocMobile_xVrC"><button type="button" class="clean-btn tocCollapsibleButton_jU__">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>复杂小程序集成</h1><h2 class="anchor anchorWithStickyNavbar__xBw" id="背景">背景<a href="#背景" class="hash-link" aria-label="背景的直接链接" title="背景的直接链接">​</a></h2><p>从 2017 年微信小程序发布开始，随着小程序的逐步发展、迭代和大量功能的开发，小程序巨大化的问题越来越突出。虽然小程序平台方提供了分包、插件两种方式来帮助小程序开发者来实现代码和功能的解耦。然而在实际的实践中，随着同一个小程序中的不同的业务逐步拆分到不同的团队，以及分包、插件、NPM 包的大量使用，不同业务团队之间的接口调用问题、包大小的管理问题、最终的小程序产物合并问题等越来越突出，基于这个背景和需求，整合饿了么在大型小程序上的各类最佳实践和解决方案，从工程化的角度出发，我们推出了 <strong>复杂小程序集成能力</strong>。</p><p>相关功能主要由 <code>@morjs/plugin-composer</code> 插件提供。</p><h2 class="anchor anchorWithStickyNavbar__xBw" id="动机">动机<a href="#动机" class="hash-link" aria-label="动机的直接链接" title="动机的直接链接">​</a></h2><p>多个独立的构建可以组成一个独立的小程序，这些独立构建之间不应该存在强依赖关系，因此可以独立开发、调试和部署。</p><p>除宿主之外，分包、插件和模块并不要求一定要采用 <code>MorJS</code> 来编写，只要符合接入方式的规范，理论上采用任何小程序框架的小程序或原生小程序均可以进行独立开发和集成。</p><p><em>注：小程序、分包、插件的打包方式归属于编译，不在这里体现。</em></p><h2 class="anchor anchorWithStickyNavbar__xBw" id="目标">目标<a href="#目标" class="hash-link" aria-label="目标的直接链接" title="目标的直接链接">​</a></h2><ul><li>提供统一的集成研发方式和流程</li><li>提供标准、可复用的集成产物规范</li><li>为复杂小程序提供解耦工具和集成方法</li><li>标准化小程序宿主、小程序插件、小程序分包、小程序模块之间的通信及能力注入方式</li><li>提供统一的路由调用，方便多形态的小程序在多种环境下路由的一致性</li><li>转 Web 之后，可基于微应用的方式进行组合（未实现）</li></ul><h2 class="anchor anchorWithStickyNavbar__xBw" id="示意图">示意图<a href="#示意图" class="hash-link" aria-label="示意图的直接链接" title="示意图的直接链接">​</a></h2><img loading="lazy" src="https://img.alicdn.com/imgextra/i4/O1CN01CeUbnD20ZJ0uIRlZG_!!6000000006863-0-tps-3672-1556.jpg" width="1200" class="img_d2mo"><h2 class="anchor anchorWithStickyNavbar__xBw" id="概念">概念<a href="#概念" class="hash-link" aria-label="概念的直接链接" title="概念的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar__xBw" id="集成">集成<a href="#集成" class="hash-link" aria-label="集成的直接链接" title="集成的直接链接">​</a></h3><p>将小程序宿主和相关子模块通过拉包、编译、构建、合并等一系列处理之后，合并为一个完整小程序的过程</p><h3 class="anchor anchorWithStickyNavbar__xBw" id="模块类型">模块类型<a href="#模块类型" class="hash-link" aria-label="模块类型的直接链接" title="模块类型的直接链接">​</a></h3><ul><li><strong>宿主</strong>：小程序主体，拥有小程序完整的权限，有 <code>appId</code>，可使用插件和分包，并可为不同的插件和分包提供共享的数据和方法</li><li><strong>主包</strong>：小程序分包的一种，每个小程序只有一个主包，用于放置默认启动页面/TabBar 页面，以及一些所有分包都需用到公共资源/JS 脚本</li><li><strong>分包</strong>：小程序分包，分为普通分包和独立分包，可申请小程序权限，使用体感接近于小程序宿主</li><li><strong>插件</strong>：小程序插件，独立发布，嵌套在小程序宿主中使用，可被订阅使用，不可单独申请小程序权限</li></ul><h3 class="anchor anchorWithStickyNavbar__xBw" id="集成模式">集成模式<a href="#集成模式" class="hash-link" aria-label="集成模式的直接链接" title="集成模式的直接链接">​</a></h3><ul><li><strong>组合模式</strong>： 集成时的模块通过自定义的脚本完成编译，不经过 <code>MorJS</code> 编译处理，<code>MorJS</code> 仅会执行脚本以及操作模块产物</li><li><strong>编译模式</strong>： 集成时的模块相关页面或组件会合并进入到 <code>MorJS</code> 的编译流程中，并与宿主产物一同输出</li></ul><h3 class="anchor anchorWithStickyNavbar__xBw" id="集成状态">集成状态<a href="#集成状态" class="hash-link" aria-label="集成状态的直接链接" title="集成状态的直接链接">​</a></h3><p>集成过程中模块在不同阶段所处的状态，用于判断模块是否需要执行当前操作，初始状态为 <strong>0</strong>，最终状态为 <strong>6</strong>，详细状态及含义如下：</p><ul><li><strong>0</strong>：初始状态</li><li><strong>1</strong>：模块已下载</li><li><strong>2</strong>：模块前置脚本已执行</li><li><strong>3</strong>：模块配置已载入</li><li><strong>4</strong>：模块已完成编译或拷贝</li><li><strong>5</strong>：模块后置脚本已执行</li><li><strong>6</strong>：模块已集成</li></ul><h3 class="anchor anchorWithStickyNavbar__xBw" id="下载类型">下载类型<a href="#下载类型" class="hash-link" aria-label="下载类型的直接链接" title="下载类型的直接链接">​</a></h3><p>集成过程中，用于将模块下载到指定位置的方式，可分为如下 5 种下载类型：</p><ul><li><strong>npm</strong>：通过 <code>NPM</code> 的方式下载，即模块以 <code>NPM</code> 包的方式发布和管理</li><li><strong>git</strong>：通过 <code>Git</code> 的方式下载，即模块以 <code>Git</code> 仓库的方式发布和管理</li><li><strong>tar</strong>：通过 <code>Tar</code> 压缩包的方式下载，即模块以某个存放在网络或 <code>CDN</code> 上的 <code>Tar</code> 资源形式存在</li><li><strong>link</strong>：通过本地软链的方式下载，即模块存储在本地某个目录中，通过软链的形式，将模块链接到指定位置</li><li><strong>file</strong>：通过本地目录拷贝的方式下载，即模块存储在本地某个目录中，通过拷贝整个目录的方式，将模块复制到指定位置</li></ul><h3 class="anchor anchorWithStickyNavbar__xBw" id="集成脚本">集成脚本<a href="#集成脚本" class="hash-link" aria-label="集成脚本的直接链接" title="集成脚本的直接链接">​</a></h3><p>集成过程中，模块需要自定义执行的脚本命令，通常用于生成模块实际用于集成的产物：</p><ul><li><strong>before</strong>：前置脚本，单一模块成功下载后执行的脚本</li><li><strong>after</strong>：后置脚本，单一模块已完成产物的拷贝或编译之后执行的脚本</li><li><strong>composed</strong>：已集成脚本，所有模块完成集成后，集成流程结束前执行的脚本</li></ul><h2 class="anchor anchorWithStickyNavbar__xBw" id="集成配置">集成配置<a href="#集成配置" class="hash-link" aria-label="集成配置的直接链接" title="集成配置的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar__xBw" id="集成开启方式">集成开启方式<a href="#集成开启方式" class="hash-link" aria-label="集成开启方式的直接链接" title="集成开启方式的直接链接">​</a></h3><p>MorJS 的集成可在两种方式下使用，一种是<strong>直接集成</strong>，一种是<strong>编译时自动集成</strong></p><h4 class="anchor anchorWithStickyNavbar__xBw" id="直接集成">直接集成<a href="#直接集成" class="hash-link" aria-label="直接集成的直接链接" title="直接集成的直接链接">​</a></h4><p>通过 <code>mor compose</code> 命令控制，不涉及到编译流程，不处理 <code>mode</code> 为 <code>compile</code> 的模块，主要的功能是将宿主和各个分包合并在一起组合成一个完整的小程序。</p><h4 class="anchor anchorWithStickyNavbar__xBw" id="编译时自动集成">编译时自动集成<a href="#编译时自动集成" class="hash-link" aria-label="编译时自动集成的直接链接" title="编译时自动集成的直接链接">​</a></h4><p>通过 <code>mor compile</code> 命令控制，涉及到编译流程，通常用于配合当前宿主或分包的线下研发。</p><p>编译时 MorJS 支持通过两种方式开启集成，使用任何一种均可：</p><ol><li>通过命令 <code>mor compile --compose</code> 中的 <code>--compose</code> 在编译时自动开启集成</li><li>通过在 MorJS 配置文件中添加 <code>{ compose: true }</code> 来自动开启集成</li></ol><h4 class="anchor anchorWithStickyNavbar__xBw" id="两者的主要区别">两者的主要区别<a href="#两者的主要区别" class="hash-link" aria-label="两者的主要区别的直接链接" title="两者的主要区别的直接链接">​</a></h4><p><code>mor compile --compose</code> 可以认为是相当于先执行项目的编译 <code>mor compile</code>, 然后将当前项目作为宿主（<code>host</code>）或其中一个模块（<code>module</code>）进行集成 <code>mor compose</code></p><h3 class="anchor anchorWithStickyNavbar__xBw" id="集成模块配置">集成模块配置<a href="#集成模块配置" class="hash-link" aria-label="集成模块配置的直接链接" title="集成模块配置的直接链接">​</a></h3><p>在 <code>mor.config.ts</code> 通过设置 <code>host: {}</code> 或 <code>modules: [{}]</code> 来配置宿主或子模块，如：</p><blockquote><p>有关 MorJS 配置的详细信息，参见：<a href="/guides/basic/config#%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E">配置说明</a></p></blockquote><div class="language-typescript codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-typescript codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">default</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">defineConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 宿主配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    host</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 子模块（如：分包等）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    modules</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>上述示例中的 <code>host</code> 和 <code>modules</code> 的配置方式基本一致，其中 <code>host</code> 只能配置一个，<code>modules</code> 可以配置多个，详细的配置方式如下：</p><div class="language-typescript codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-typescript codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 模块名称, 可选值, 默认会基于 `npm` 或 `git` 或 `tar` 或 `link` 或 `file` 配置自动生成</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 模块集成模式, 默认为 `compose`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   *  - compose: 通过 compose 方式集成, 通过拷贝的方式复制到产物目录</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   *  - compile: 通过 compile 方式集成, 需要通过 mor 编译流程</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  mode</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;compose&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 模块类型, 默认为 `subpackage`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   *  - 声明为 宿主（host） 的模块，模块中包含 app.json 并作为其他模块集成的目标，配置在 `host` 中的模块，该类型固定为 `host `</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   *  - 声明为 主包（main） 的模块，会将页面插入到小程序 app.json 的 pages 中</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   *  - 声明为 分包（subpackage） 的模块，会将页面插入到小程序 app.json 的 subPackages 中</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   *  - 声明为 插件（plugin） 的模块: 功能研发中</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  type</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;subpackage&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 下载配置</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * npm / git / tar / link / file 均用于下载模块, 只需要配置一个即可</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 如果同时配置了多个，则只会有一个下载配置生效，优先级为：npm &gt; git &gt; tar &gt; link &gt; file</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* 通过 npm 配置模块下载 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 字符串方式配置，如:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  npm</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;your_package@1.2.0&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 对象方式配置，如：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  npm</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// npm 名称</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;your_package&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// npm 版本, 默认为 `latest`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    version</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;1.2.0&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* 通过 git 仓库配置模块下载 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 字符串方式配置，如:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  git</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;git@github.com:abc/cde.git#master&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 对象方式配置，如：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 注意: branch/tag/commit 的优先级为 commit &gt; tag &gt; branch, 相关字段均配置后，会按照优先级取用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  git</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 仓库地址, 支持 git/http/https/ssh 协议链接</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;git@github.com:abc/cde.git&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 分支配置, 默认为 HEAD</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    branch</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;develop&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 标签配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    tag</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;v1.1.0&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Git 提交 commit id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    commit</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* 通过 tar 配置模块下载 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 字符串方式配置，如:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  tar</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;https://your_domain.com/abc.tar.gz&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 对象方式配置，如：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  tar</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;https://your_domain.com/abc.tar.gz&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 支持增加扩展参数, 参见 got 配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* 通过 link 配置（软链）模块下载 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 字符串方式配置，如:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  link</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;/Users/yourHomeDir/Workspace/yourCustomHostPath&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 对象方式配置，如：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  link</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    path</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;/Users/yourHomeDir/Workspace/yourCustomHostPath&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* 通过 file 配置（复制）模块下载 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 字符串方式配置，如:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  file</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;/Users/yourHomeDir/Workspace/yourCustomHostPath&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 对象方式配置，如：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  file</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    path</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;/Users/yourHomeDir/Workspace/yourCustomHostPath&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 构建产物目录配置, 默认为 `dist`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// dist 配置的作用是告知 mor 当前模块的产物所存放的目录位置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  dist</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;dist&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 集成构建过程中可执行的脚本, 可选配置</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  scripts</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 执行脚本时的公共环境变量, 可选配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// mor 默认会注入如下环境变量:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//   MOR_COMPOSER_MODULE_CWD: 当前模块工作目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//   MOR_COMPOSER_MODULE_TYPE: 当前模块类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//   MOR_COMPOSER_MODULE_HASH: 当前模块 hash 信息, 用于 mor 内部判断是否需要重新下载模块</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//   MOR_COMPOSER_MODULE_ROOT: 当前模块根目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//   MOR_COMPOSER_MODULE_SOURCE: 当前模块源码目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//   MOR_COMPOSER_MODULE_OUTPUT_FROM: 当前模块原始产物目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//   MOR_COMPOSER_MODULE_OUTPUT_TO: 当前模块集成产物目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    env</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 模块编译或拷贝前执行脚本, 可选配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    before</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 可以直接以字符串的方式配置命令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;npm i&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 也可以以对象的方式配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 需要执行的命令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        command</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cd some_dir &amp;&amp; mor compile&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 该命令的自定义环境变量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        env</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token constant" style="color:rgb(130, 170, 255)">CUSTOM_ENV</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;CUSTOM_ENV_VALUE&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 该命令的选项, 参见 execa.command 的 options 配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        options</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          shell</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 模块编译完成后或拷贝后执行脚本，配置方式同 before，可选配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    after</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 所有模块完成集成之后执行脚本，配置方式同 before，可选配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    composed</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 脚本执行公共选项, 参见 execa.command 的 options 配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    options</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   * 模块配置内容，参见下方集成产物规范的 [config].json 描述</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  config</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">undefined</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar__xBw" id="集成产物规范">集成产物规范<a href="#集成产物规范" class="hash-link" aria-label="集成产物规范的直接链接" title="集成产物规范的直接链接">​</a></h2><p>集成产物是指可用于参与到小程序集成的标准模块产物，具备以下特点：</p><ul><li>框架无关</li><li>可复用</li><li>自描述</li></ul><p>模块文件目录结构：</p><div class="language-bash codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-bash codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">module name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">                 - 以模块名称命名的模块根目录，可以由模块配置的 </span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable" style="color:rgb(191, 199, 213)">name</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain"> 指定或基于下载配置自动生成</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">hash</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">                    - 模块源码或产物所在目录, </span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable builtin class-name" style="color:rgb(255, 203, 107)">hash</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain"> 是由模块配置中的 </span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable function" style="color:rgb(130, 170, 255)">git</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable function" style="color:rgb(130, 170, 255)">npm</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable function" style="color:rgb(130, 170, 255)">tar</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable" style="color:rgb(191, 199, 213)">dist</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain">/</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable" style="color:rgb(191, 199, 213)">mode</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain"> 字段生成的 MD5 值，用于辅助判断是否需要重新下载模块</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">dist?</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">               - 模块产物所在目录，以 mor.compose.json 中的 output.from 指向目录为准</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   └── </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">.json     - 模块产物配置文件，不同的模块类型的配置文件均不相同，与 mor.compose.json 文件的 config 字段作用相同</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└── mor.compose.json          - 模块描述文件</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar__xBw" id="集成产物临时目录">集成产物临时目录<a href="#集成产物临时目录" class="hash-link" aria-label="集成产物临时目录的直接链接" title="集成产物临时目录的直接链接">​</a></h3><p>MorJS 会将集成产物统一存放到项目根目录的 <code>.mor/composer</code> 临时目录中，其中宿主模块会统一放在 <code>.mor/composer/hosts</code> 目录中，子模块会统一放在 <code>.mor/composer/modules</code> 目录中。</p><p>集成的宿主模块和各个子模块的状态都是独立维护的，比如某次执行集成命令：</p><div class="language-bash codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-bash codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ ┌──────────────────────────────────────────────┬────────────────┬──────┬──────┬──────┐</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ 模块 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">共 </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> 个, 集成终态: 已集成</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">                 │ 版本           │ 类型  │ 模式  │ 结果 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ miniprogram_host                             │ *              │ 宿主  │ 编译 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ subpackage1                                  │ dev/1.0.0      │ 分包  │ 组合 │  ✖   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ subpackage2                                  │ feat/1.0.0     │ 分包  │ 组合 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ subpackage3                                  │ feature/1.0.0  │ 分包  │ 组合 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ subpackage4                                  │ dev/1.1.0      │ 分包  │ 组合 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ subpackage5                                  │ feature/1.1.0  │ 分包  │ 组合 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        └──────────────────────────────────────────────┴────────────────┴──────┴──────┴──────┘</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>上方集成的模块中，<code>subpackage1</code> 模块集成失败，可直接通过删除目录 <code>.mor/composer/modules/subpackage1</code> 后重新运行命令，也可以通过命令行</p><div class="language-bash codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-bash codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token plain">npx mor clean all</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>来清理 MorJS 的缓存目录 <code>node_modules/.cache/mor</code> 和临时文件目录 <code>.mor</code> 后，重新运行之前的集成命令。</p><p>通常情况下，推荐只删除出问题的模块，这样当再次运行集成命令时，已完成集成的模块，会被跳过，可大大节约集成时间。</p><h3 class="anchor anchorWithStickyNavbar__xBw" id="模块描述文件--morcomposejson">模块描述文件 —— mor.compose.json<a href="#模块描述文件--morcomposejson" class="hash-link" aria-label="模块描述文件 —— mor.compose.json的直接链接" title="模块描述文件 —— mor.compose.json的直接链接">​</a></h3><p>模块描述文件的主要作用是：描述一个名为 <code>name</code> 状态为 <code>state</code> 的模块需要将自身的产物通过集成模式 <code>mode</code> 的方式从目录 <code>output.from</code> 集成到目录 <code>output.to</code> 中，并将配置 <code>config</code> 合并到小程序的 <code>app.json</code> 文件中。</p><div class="language-javascript codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-javascript codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 模块名称，该名称和模块所在目录名称一致</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;miniapp-subpackage-name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 模块类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;subpackage&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 集成模式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;mode&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;compose&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 模块 hash 目录，基于模块配置生成，用于确保当前模块内容的唯一性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;hash&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;dc66928b089d5e14b77bdbdb09f4b60a&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 模块所在目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;root&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;.mor/composer/modules/miniapp-subpackage-name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 模块源代码所在目录，通常用于结合脚本生成最终产物</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;source&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;.mor/composer/modules/miniapp-subpackage-name/dc66928b089d5e14b77bdbdb09f4b60a&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 模块集成状态</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;state&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 模块产物输出配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;output&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 当前模块的产物所在目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string-property property">&quot;from&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;.mor/composer/modules/miniapp-subpackage-name/dc66928b089d5e14b77bdbdb09f4b60a&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 需要将当前模块产物复制到的目标目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string-property property">&quot;to&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;dist/subpackageName&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 模块配置文件，作用同 app.json/plugin.json/subpackage.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;config&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string-property property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;main&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string-property property">&quot;root&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;subpackageName&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string-property property">&quot;pages&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pages/index/index&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar__xBw" id="模块产物配置文件--configjson">模块产物配置文件 —— <!-- -->[config]<!-- -->.json<a href="#模块产物配置文件--configjson" class="hash-link" aria-label="模块产物配置文件--configjson的直接链接" title="模块产物配置文件--configjson的直接链接">​</a></h3><p>模块配置文件，不同类型的模块配置文件按照如下规则配置：</p><ul><li>宿主（<code>host</code>）：使用 <code>app.json</code> 配置文件，该文件和小程序的 <code>app.json</code> 配置方式一致</li><li>主包（<code>main</code>）：使用 <code>subpackage.json</code> 配置文件，该文件和小程序的 <code>app.json</code> 的 <code>subpackages</code> 字段条目配置方式一致，区别在于扩展了 <code>&quot;type&quot;: &quot;main&quot;</code> 用于标记当前模块为主包模块</li><li>分包（<code>subpackage</code>）：使用 <code>subpackage.json</code> 配置文件，该文件和小程序的 <code>app.json</code> 的 <code>subpackages</code> 字段条目配置方式一致</li><li>插件（<code>plugin</code>）：使用 <code>plugin.json</code> 配置文件，该文件和小程序插件的 <code>plugin.json</code> 配置方式一致</li></ul><p>模块配置示例</p><div class="language-javascript codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-javascript codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/* 配置示例 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 小程序 app.json 配置示例</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 详细配置可参见微信小程序或支付宝小程序 app.json 配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;pages&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pages/todos/todos&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pages/add-todo/add-todo&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// subpackages 或 subPackages 均可</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;subPackages&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token string-property property">&quot;root&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token string-property property">&quot;pages&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pages/profile/profile&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 小程序插件 plugin.json 配置示例</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 详细配置可参见微信小程序或支付宝小程序 plugin.json 配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;publicComponents&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string-property property">&quot;list&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;components/list/list&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;publicPages&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string-property property">&quot;hello-page&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pages/index/index&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;pages&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pages/index/index&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pages/another/index&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 插件导出的模块文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;main&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;index.js&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 小程序分包 subpackage.json 配置示例</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 配置方式同 app.json 中的 subpackages 的单个分包配置方式一致</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// type 字段为 mor 独有, 用于标识该分包为 &quot;subpackage&quot; 或 &quot;main&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 区别是: 集成时 &quot;subpackage&quot; 类型的分包会被自动合并到 app.json 的 subpackages 字段中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//              &quot;main&quot; 类型的分包会被自动合并到 app.json 的 pages 字段中 (即: 合并至主包)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;subpackage&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// root 字段将影响集成时分包产物合并至宿主小程序时的根目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;root&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 注意: 编译分包以 pages 作为实际路径进行解析</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string-property property">&quot;pages&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pages/profile/profile&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar__xBw" id="实际模块示例">实际模块示例<a href="#实际模块示例" class="hash-link" aria-label="实际模块示例的直接链接" title="实际模块示例的直接链接">​</a></h3><div class="language-bash codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-bash codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token plain">miniapp-subpackage-name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── dc66928b089d5e14b77bdbdb09f4b60a</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── dist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   ├── components</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   ├── pages</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   │   └── index</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   │       ├── index.js</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   │       ├── index.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   │       ├── index.wxml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   │       └── index.wxss</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   │   └── subpackage.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└── mor.compose.json</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar__xBw" id="用法举例">用法举例<a href="#用法举例" class="hash-link" aria-label="用法举例的直接链接" title="用法举例的直接链接">​</a></h2><p>这里会简单列举三种集成研发模式，来帮助大家理解集成的具体作用和使用方法。</p><h3 class="anchor anchorWithStickyNavbar__xBw" id="主子分包研发模式">主/子分包研发模式<a href="#主子分包研发模式" class="hash-link" aria-label="主/子分包研发模式的直接链接" title="主/子分包研发模式的直接链接">​</a></h3><p>业务可基于业务对小程序中的分包进行拆分，以达到各个业务相互解耦，独立迭代的目的，参见下方分包配置示例：</p><div class="language-typescript codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-typescript codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> defineConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> takin </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@morjs/cli&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">default</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">defineConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;tt&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    sourceType</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;alipay&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    target</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bytedance&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    modules</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 主入口包</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;miniapp-entry&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        git</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;git@github.com:abc/miniapp-entry.git&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          branch</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;dev/1.0.0&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        scripts</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          before</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;npm i&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;npm run build:dy&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dist</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;dist/dy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 搜索分包</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        git</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;git@github.com:abc/eleme-miniapp-plugin-search.git&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          branch</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;feat/upgrade-to-mor-2&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        scripts</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          before</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;npm i&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cd plugin &amp;&amp; npm i&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;mor compile --name dy&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dist</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;miniprogram_tt/dist&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 红包分包</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        git</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;git@github.com:abc/vouchers.git&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          branch</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;feature/dy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        scripts</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          before</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;npm i&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cd plugin &amp;&amp; npm i&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;mor compile --name dy&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dist</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;dist/bytedance&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 订单列表</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        git</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;git@github.com:abc/miniapp-plugin-orderlist.git&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          branch</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;dev/dy/10.12.5&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        scripts</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          before</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;npm i&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;npm run build:dy&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dist</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;build/_bytedance&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 平台(地址管理)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        git</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;git@github.com:abc/king-home-alipay.git&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          branch</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;feature/dy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        scripts</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          before</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;npm i&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;mor compile --name douyin_subpackage&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dist</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;dist&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>通过 <code>MorJS</code> 命令：<code>mor compile --compose</code> 即可集成上述配置中宿主和相关的分包。</p><p>运行结果示例：</p><div class="language-bash codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-bash codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ⚑ 当前 MorJS 为开源版本: @morjs/cli@1.0.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 发现配置文件: mor.config.ts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 配置文件加载成功: mor.config.ts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 小程序集成功能已开启</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 即将开始集成以下模块</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">最大并发数: </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ ┌──────────────────────────────────────────────┬────────────────┬──────┬──────┐</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ 模块 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">共 </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> 个, 集成终态: 已集成</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">                 │ 版本           │ 类型  │ 模式  │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ miniprogram_host                             │ *              │ 宿主  │ 编译 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ miniapp-entry                                │ dev/dy_10.12.5 │ 分包  │ 组合 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ eleme-ad_eleme-miniapp-plugin-search         │ feat/upgrade-… │ 分包  │ 组合 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ mini-foundation_vouchers                     │ feature/dy     │ 分包  │ 组合 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ eleme_miniapp-plugin-orderlist               │ dev/dy/10.12.5 │ 分包  │ 组合 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ alsc-mini-app_king-home-alipay               │ feature/dy     │ 分包  │ 组合 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        └──────────────────────────────────────────────┴────────────────┴──────┴──────┘</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 eleme_miniapp-plugin-orderlist 前置脚本开始执行</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 eleme_miniapp-plugin-orderlist 执行命令: </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 alsc-mini-app_king-home-alipay 开始下载</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 eleme-ad_eleme-miniapp-plugin-search 前置脚本开始执行</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 eleme-ad_eleme-miniapp-plugin-search 执行命令: </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 mini-foundation_vouchers 前置脚本开始执行</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 mini-foundation_vouchers 执行命令: </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 模块 alsc-mini-app_king-home-alipay 下载成功</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 alsc-mini-app_king-home-alipay 前置脚本开始执行</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 alsc-mini-app_king-home-alipay 执行命令: </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 eleme_miniapp-plugin-orderlist 执行命令: </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run build:dy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 模块 eleme_miniapp-plugin-orderlist 前置脚本执行成功, 耗时: </span><span class="token number" style="color:rgb(247, 140, 108)">27</span><span class="token plain">.440s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 alsc-mini-app_king-home-alipay 执行命令: mor compile --name douyin_subpackage</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 模块 alsc-mini-app_king-home-alipay 前置脚本执行成功, 耗时: </span><span class="token number" style="color:rgb(247, 140, 108)">70</span><span class="token plain">.623s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 mini-foundation_vouchers 执行命令: </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> plugin </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 mini-foundation_vouchers 执行命令: mor compile --name dy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 eleme-ad_eleme-miniapp-plugin-search 执行命令: </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> plugin </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 模块 mini-foundation_vouchers 前置脚本执行成功, 耗时: </span><span class="token number" style="color:rgb(247, 140, 108)">93</span><span class="token plain">.399s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块 eleme-ad_eleme-miniapp-plugin-search 执行命令: mor compile --name dy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 模块 eleme-ad_eleme-miniapp-plugin-search 前置脚本执行成功, 耗时: </span><span class="token number" style="color:rgb(247, 140, 108)">115</span><span class="token plain">.475s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 准备配置中, 即将开始编译 👇</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        配置名称: tt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译目标: 字节小程序</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译环境: development</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译类型: 小程序</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译模式: bundle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        源码类型: alipay</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        源码目录: src</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        输出目录: dist/bytedance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 已开启缓存, 可通过 --no-cache 关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 已开启 node_modules 组件处理</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 开始编译 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 依赖分析中 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 依赖分析完成: 耗时: </span><span class="token number" style="color:rgb(247, 140, 108)">86.012583</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块集成结果:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ ┌──────────────────────────────────────────────┬────────────────┬──────┬──────┬──────┐</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ 模块 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">共 </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> 个, 集成终态: 已集成</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">                 │ 版本           │ 类型  │ 模式  │ 结果 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ miniprogram_host                             │ *              │ 宿主  │ 编译 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ miniapp-entry                                │ dev/dy_10.12.5 │ 分包  │ 组合 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ eleme-ad_eleme-miniapp-plugin-search         │ feat/upgrade-… │ 分包  │ 组合 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ mini-foundation_vouchers                     │ feature/dy     │ 分包  │ 组合 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ eleme_miniapp-plugin-orderlist               │ dev/dy/10.12.5 │ 分包  │ 组合 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ alsc-mini-app_king-home-alipay               │ feature/dy     │ 分包  │ 组合 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        └──────────────────────────────────────────────┴────────────────┴──────┴──────┴──────┘</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 集成产物目录: dist/bytedance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 编译完成, 耗时: </span><span class="token number" style="color:rgb(247, 140, 108)">127941.680666</span><span class="token plain"> ms</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>用小程序 IDE 打开 dist/bytedance 目录即可预览集成后的完整小程序。</p><h3 class="anchor anchorWithStickyNavbar__xBw" id="sdk-研发模式">SDK 研发模式<a href="#sdk-研发模式" class="hash-link" aria-label="SDK 研发模式的直接链接" title="SDK 研发模式的直接链接">​</a></h3><p>业务可将通用页面封装置某个 <code>NPM</code> 包中作为通用功能，如统一宿主的 <code>Solution</code> 配置，参见下方示例：</p><div class="language-typescript codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-typescript codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> defineConfig </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@morjs/cli&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">default</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">defineConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;tt&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    target</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bytedance&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 配置需要的 SDK</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    modules</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 指定 npm 名称和版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        npm</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;mor-runtime-solution-standard-eleme&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          version</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;1.0.4&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 通过编译的模式参与集成</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        mode</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;compile&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 作为主包模块进行集成</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        type</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;main&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// mor-runtime-solution-standard-eleme 包中的产物地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dist</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./src&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 通过配置注入的页面内容：涉及 webview 和登录的页面和组件，由当前 solution 统一收口维护</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 集成编译后，配置中的页面将会合并至 app.json 的 pages 字段中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        config</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          pages</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-property property">&#x27;pages/container/index&#x27;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;pages/container/index&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-property property">&#x27;pages/container-transnavbar/index&#x27;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;pages/container-transnavbar/index&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-property property">&#x27;pages/auth/index&#x27;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;pages/auth/index&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-property property">&#x27;pages/havana/index&#x27;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;pages/havana/index&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>通过 <code>MorJS</code> 命令：<code>mor compile --compose</code> 即可集成上述配置中的页面。</p><p>运行结果示例：</p><div class="language-bash codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-bash codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ⚑ 当前 MorJS 为开源版本: @morjs/cli@1.0.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 发现配置文件: mor.config.ts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 配置文件加载成功: mor.config.ts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 小程序集成功能已开启</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 即将开始集成以下模块</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">最大并发数: </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ ┌──────────────────────────────────────────────┬────────────────┬──────┬──────┐</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ 模块 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">共 </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> 个, 集成终态: 已集成</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">                 │ 版本           │ 类型  │ 模式  │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ miniprogram_host                             │ *              │ 宿主  │ 编译 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ ali_mor-runtime-solution-standard-eleme_1_0… │ </span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token plain">.4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">  │ 主包  │ 编译 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        └──────────────────────────────────────────────┴────────────────┴──────┴──────┘</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 准备配置中, 即将开始编译 👇</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        配置名称: tt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译目标: 字节小程序</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译环境: development</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译类型: 小程序</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译模式: bundle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        源码类型: alipay</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        源码目录: src</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        输出目录: dist/bytedance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 已开启缓存, 可通过 --no-cache 关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 已开启 node_modules 组件处理</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 开始编译 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 依赖分析中 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 依赖分析完成: 耗时: </span><span class="token number" style="color:rgb(247, 140, 108)">1639.405709</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块集成结果:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ ┌──────────────────────────────────────────────┬────────────────┬──────┬──────┬──────┐</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ 模块 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">共 </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> 个, 集成终态: 已集成</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">                 │ 版本           │ 类型  │ 模式  │ 结果 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ miniprogram_host                             │ *              │ 宿主  │ 编译  │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ ali_mor-runtime-solution-standard-eleme_1_0… │ </span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token plain">.4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">  │ 主包  │ 编译 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        └──────────────────────────────────────────────┴────────────────┴──────┴──────┴──────┘</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 集成产物目录: dist/bytedance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 编译完成, 耗时: </span><span class="token number" style="color:rgb(247, 140, 108)">14175.584625</span><span class="token plain"> ms</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar__xBw" id="小程序插件研发模式">小程序插件研发模式<a href="#小程序插件研发模式" class="hash-link" aria-label="小程序插件研发模式的直接链接" title="小程序插件研发模式的直接链接">​</a></h3><p>由于小程序插件无法独立运行，且对产物目录结构有特殊的要求，如：</p><div class="language-bash codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-bash codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token plain">dist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── miniprogram</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── plugin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└── mini.project.json</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>基于这种情况，我们可以利用 <code>MorJS</code> 的集成功能，来实现插件研发，参考配置如下：</p><div class="language-typescript codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-typescript codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> defineConfig </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;@morjs/cli&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">default</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">defineConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;alipay_plugin&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    sourceType</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;alipay&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    target</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;alipay&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 编译类型为 插件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    compileType</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;plugin&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    compileMode</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bundle&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 配置插件宿主</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    host</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      git</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;git@github.com:abc/king-home-alipay.git&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        branch</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;master&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      scripts</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        before</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;npm i&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;npm run compile:ali&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      dist</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;_ali&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    outputPath</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;dist&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 插件源码目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    srcPath</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;plugin&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    autoClean</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>通过 <code>MorJS</code> 命令：<code>mor compile --name alipay_plugin --compose</code> 即可集成上述配置中的小程序插件及其宿主。</p><p>运行结果示例：</p><div class="language-bash codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-bash codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ⚑ 当前 MorJS 为开源版本: @morjs/cli@1.0.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 发现配置文件: mor.config.ts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 配置文件加载成功: mor.config.ts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 小程序集成功能已开启</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 即将开始集成以下模块</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">最大并发数: </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ ┌──────────────────────────────────────────────┬────────────────┬──────┬──────┐</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ 模块 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">共 </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> 个, 集成终态: 已集成</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">                 │ 版本           │ 类型  │ 模式  │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ alsc-mini-app_king-home-alipay               │ master         │ 宿主  │ 组合 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        └──────────────────────────────────────────────┴────────────────┴──────┴──────┘</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 准备配置中, 即将开始编译 👇</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        配置名称: alipay_plugin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译目标: 支付宝小程序</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译环境: development</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译类型: 插件</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译模式: bundle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        源码类型: alipay</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        源码目录: plugin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        编译产物: dist/plugin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        输出目录: dist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 已开启缓存, 可通过 --no-cache 关闭</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 启动文件监听模式</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 开始编译 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 依赖分析中 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 依赖分析完成: 耗时: </span><span class="token number" style="color:rgb(247, 140, 108)">12.790667</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ⠼ 正在编译, 进度: </span><span class="token number" style="color:rgb(247, 140, 108)">99.00</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ 模块集成结果:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ℹ ┌──────────────────────────────────────────────┬────────────────┬──────┬──────┬──────┐</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ 模块 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">共 </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> 个, 集成终态: 已集成</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">                 │ 版本           │ 类型  │ 模式  │ 结果 │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ├──────────────────────────────────────────────┼────────────────┼──────┼──────┼──────┤</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        │ alsc-mini-app_king-home-alipay               │ master         │ 宿主  │ 组合 │  ✔   │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        └──────────────────────────────────────────────┴────────────────┴──────┴──────┴──────┘</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 集成产物目录: dist/miniprogram</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> ✔ 编译完成, 耗时: </span><span class="token number" style="color:rgb(247, 140, 108)">1544.04675</span><span class="token plain"> ms</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>用小程序 IDE 打开 dist 目录即可预览小程序插件。</p><h2 class="anchor anchorWithStickyNavbar__xBw" id="命令行说明">命令行说明<a href="#命令行说明" class="hash-link" aria-label="命令行说明的直接链接" title="命令行说明的直接链接">​</a></h2><p>除了通过 <a href="/guides/basic/config#%E9%9B%86%E6%88%90%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE">配置</a> 的方式来使用集成能力之外，部分功能也可以结合命令行来使用，命令行的优先级高于用户配置，具体参见下方说明：</p><div class="language-bash codeBlockContainer_eT2D theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kD4G"><pre tabindex="0" class="prism-code language-bash codeBlock_Lgdw thin-scrollbar"><code class="codeBlockLines_XBnb"><span class="token-line" style="color:#bfc7d5"><span class="token plain">集成相关命令行用法:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  $ mor compose 或 mor compile --compose</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">集成相关命令行选项:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --with-modules </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">moduleName</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">     指定需要参与集成的模块, 基于模块的名称筛选, 支持 glob 模式，如需指定多个，可用逗号（,）分割，示例： --with-modules </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;*eleme-solution,*plugin-entry&#x27;</span><span class="token plain"> 或 --with-modules </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;*eleme-solution,*plugin-entry&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --without-modules </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">moduleName</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">  排除不需要集成的模块, 基于模块的名称筛选, 支持 glob 模式，用法和 --with-modules 类似</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --from-state </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">            控制模块集成时的初始状态, 可选值: </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">-6，每个状态码对应的含义参见文档内 </span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable" style="color:rgb(191, 199, 213)">集成状态</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain"> 的描述</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --to-state </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">              控制模块集成时的最终状态, 可选值: </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain">-6，每个状态码对应的含义参见文档内 </span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token variable" style="color:rgb(191, 199, 213)">集成状态</span><span class="token variable" style="color:rgb(191, 199, 213)">`</span><span class="token plain"> 的描述</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --concurrency </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">number</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">          控制模块集成时的并发数量，默认会基于本机 CPU 核数和内存 GB 数生成一个并发数量</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --combine-modules               合并模块配置（主要用于合并分包配置的页面到主包中），用于适配抖音小程序的流加载</span><br></span></code></pre><div class="buttonGroup_dwCQ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_jv6c" aria-hidden="true"><svg class="copyButtonIcon_f4ZS" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_zaSK" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar__xBw" id="集成流程定制">集成流程定制<a href="#集成流程定制" class="hash-link" aria-label="集成流程定制的直接链接" title="集成流程定制的直接链接">​</a></h2><p><code>MorJS</code> 提供了若干 <code>Hooks</code> 用于支持工程插件定制集成流程。</p><p>有关集成 <code>Hooks</code> 可参见文档：<a href="/api/engineering-hooks#%E9%9B%86%E6%88%90-hooks">工程 API - Hooks - 集成 Hooks</a></p><p>关于如何编写工程插件，可参见文档：<a href="/guides/basic/plugin#%E5%BC%80%E5%8F%91%E5%B7%A5%E7%A8%8B%E6%8F%92%E4%BB%B6">插件 - 如何开发插件 - 开发工程插件</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/guides/conditional-compile/file-level"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">条件编译 (文件维度)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/guides/advance/unity-of-forms"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">小程序形态一体化</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_alMS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#背景" class="table-of-contents__link toc-highlight">背景</a></li><li><a href="#动机" class="table-of-contents__link toc-highlight">动机</a></li><li><a href="#目标" class="table-of-contents__link toc-highlight">目标</a></li><li><a href="#示意图" class="table-of-contents__link toc-highlight">示意图</a></li><li><a href="#概念" class="table-of-contents__link toc-highlight">概念</a><ul><li><a href="#集成" class="table-of-contents__link toc-highlight">集成</a></li><li><a href="#模块类型" class="table-of-contents__link toc-highlight">模块类型</a></li><li><a href="#集成模式" class="table-of-contents__link toc-highlight">集成模式</a></li><li><a href="#集成状态" class="table-of-contents__link toc-highlight">集成状态</a></li><li><a href="#下载类型" class="table-of-contents__link toc-highlight">下载类型</a></li><li><a href="#集成脚本" class="table-of-contents__link toc-highlight">集成脚本</a></li></ul></li><li><a href="#集成配置" class="table-of-contents__link toc-highlight">集成配置</a><ul><li><a href="#集成开启方式" class="table-of-contents__link toc-highlight">集成开启方式</a></li><li><a href="#集成模块配置" class="table-of-contents__link toc-highlight">集成模块配置</a></li></ul></li><li><a href="#集成产物规范" class="table-of-contents__link toc-highlight">集成产物规范</a><ul><li><a href="#集成产物临时目录" class="table-of-contents__link toc-highlight">集成产物临时目录</a></li><li><a href="#模块描述文件--morcomposejson" class="table-of-contents__link toc-highlight">模块描述文件 —— mor.compose.json</a></li><li><a href="#模块产物配置文件--configjson" class="table-of-contents__link toc-highlight">模块产物配置文件 —— config.json</a></li><li><a href="#实际模块示例" class="table-of-contents__link toc-highlight">实际模块示例</a></li></ul></li><li><a href="#用法举例" class="table-of-contents__link toc-highlight">用法举例</a><ul><li><a href="#主子分包研发模式" class="table-of-contents__link toc-highlight">主/子分包研发模式</a></li><li><a href="#sdk-研发模式" class="table-of-contents__link toc-highlight">SDK 研发模式</a></li><li><a href="#小程序插件研发模式" class="table-of-contents__link toc-highlight">小程序插件研发模式</a></li></ul></li><li><a href="#命令行说明" class="table-of-contents__link toc-highlight">命令行说明</a></li><li><a href="#集成流程定制" class="table-of-contents__link toc-highlight">集成流程定制</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/guides/basic/config">MorJS 配置</a></li><li class="footer__item"><a class="footer__link-item" href="/guides/basic/cli">命令行</a></li><li class="footer__item"><a class="footer__link-item" href="/api/engineering-hooks">工程 Hooks</a></li></ul></div><div class="col footer__col"><div class="footer__title">帮助</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/guides/faq">常见问题</a></li><li class="footer__item"><a href="https://qr.dingtalk.com/action/joingroup?code=v1,k1,zPirp4W1FDF7tKteTDgOjgk7cMzCTt31ztWoGVMVJ7U=&amp;_dt_no_comment=1&amp;origin=11" target="_blank" rel="noopener noreferrer" class="footer__link-item">社区钉钉群<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_mmbx"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/eleme/morjs/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Issue<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_mmbx"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/eleme/morjs/blob/master/CODE_OF_CONDUCT.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">行为规范</a></li><li class="footer__item"><a href="https://github.com/eleme/morjs/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">参与贡献<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_mmbx"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 - Present MorJS.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b55f68b3.js"></script>
<script src="/assets/js/main.6ba98fb8.js"></script>
</body>
</html>